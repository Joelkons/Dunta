(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(b){var a=(function(){function c(){var s=this;var g=function(){var B=[s.options.wrapperClass];if(s.options.theme!==""){B.push("br-theme-"+s.options.theme)}s.$elem.wrap(b("<div />",{"class":B.join(" ")}))};var l=function(){s.$elem.unwrap()};var A=function(){var B;if(s.options.initialRating){B=b('option[value="'+s.options.initialRating+'"]',s.$elem)}else{B=b("option:selected",s.$elem)}return B};var r=function(B){var C=s.$elem.data("barrating");if(typeof B!=="undefined"){return C[B]}return C};var j=function(B,C){if(C!==null&&typeof C==="object"){s.$elem.data("barrating",C)}else{s.$elem.data("barrating")[B]=C}};var q=function(){var B=A();j(null,{userOptions:s.options,ratingValue:B.val(),ratingText:(B.data("html"))?B.data("html"):B.text(),originalRatingValue:B.val(),originalRatingText:(B.data("html"))?B.data("html"):B.text(),readOnly:s.options.readonly,deselectable:(!s.$elem.find("option:first").val())?true:false})};var z=function(){s.$elem.removeData("barrating")};var k=function(){return r("ratingText")};var h=function(){return r("ratingValue")};var n=function(){var B=b("<div />",{"class":"br-widget"});s.$elem.find("option").each(function(){var F,E,C,D;F=b(this).val();if(F){E=b(this).text();C=b(this).data("html");if(C){E=C}D=b("<div/>",{title:E,"class":"zrdn-barrating","data-rating-value":F,"data-rating-text":E,html:(s.options.showValues)?E:""});B.append(D)}});if(s.options.showSelectedRating){B.append(b("<div />",{text:"","class":"br-current-rating"}))}if(s.options.reverse){B.addClass("br-reverse")}if(s.options.readonly){B.addClass("br-readonly")}return B};var t=function(){if(s.options.reverse){return"nextAll"}else{return"prevAll"}};var y=function(B){val=Math.floor(B);s.$elem.find('option[value="'+B+'"]').prop("selected",true).val(val);s.$elem.change()};var u=function(B){B=B?B:k();if(s.options.showSelectedRating){s.$elem.parent().find(".br-current-rating").text(B)}};var x=function(){s.$widget.find(".zrdn-barrating").removeClass("br-selected br-current");var C=h();var D=Math.floor(C);var B=C-Math.floor(C)===0.5?true:false;if(B){s.$widget.find('.zrdn-barrating[data-rating-value="'+C+'"]').next().addClass("br-selected br-current-half")[t()]().addClass("br-selected")}else{s.$widget.find('.zrdn-barrating[data-rating-value="'+C+'"]').addClass("br-selected br-current")[t()]().addClass("br-selected")}};var o=function(B){return(B.hasClass("br-current")&&r("deselectable"))};var f=function(B){B.on("click.barrating",function(D){var F=b(this),E,G;D.preventDefault();B.removeClass("br-active br-selected");F.addClass("br-selected")[t()]().addClass("br-selected");E=F.attr("data-rating-value");F.attr("data-rating-value",Math.floor(E));G=F.attr("data-rating-text");if(o(F)){F.removeClass("br-selected br-current br-current-half")[t()]().removeClass("br-selected br-current");E="";G=""}else{B.removeClass("br-current br-current-half");F.addClass("br-current")}var C=Math.floor(E);j("ratingValue",C);j("ratingText",G);y(E);u(G);s.options.onSelect.call(s,h(),k(),D);return false})};var v=function(B){B.on("mouseenter.barrating",function(){var C=b(this);console.log("on mouseenter");B.removeClass("br-active br-selected br-current br-current-half");C.addClass("br-active")[t()]().addClass("br-active");u(C.attr("data-rating-text"))})};var i=function(B){s.$widget.on("mouseleave.barrating",function(){B.removeClass("br-active");u();x()})};var m=function(B){B.on("touchstart.barrating",function(C){C.preventDefault();C.stopPropagation();b(this).click()})};var d=function(B){B.on("click.barrating",function(C){C.preventDefault()})};var e=function(B){f(B);if(s.options.hoverState){v(B);i(B)}};var p=function(B){B.off(".barrating")};var w=function(B){$elements=s.$widget.find(".zrdn-barrating");if(m){m($elements)}if(B){p($elements);d($elements)}else{e($elements)}};this.show=function(){if(r()){return}g();q();s.$widget=n();s.$widget.insertAfter(s.$elem);x();u();w(s.options.readonly);s.$elem.hide()};this.readonly=function(B){if(typeof B!=="boolean"||r("readOnly")==B){return}w(B);j("readOnly",B);s.$widget.toggleClass("br-readonly")};this.set=function(C){var B=r("userOptions");if(!s.$elem.find('option[value="'+C+'"]').val()){return}j("ratingValue",C);j("ratingText",s.$elem.find('option[value="'+C+'"]').text());y(h());u(k());x();if(!B.silent){B.onSelect.call(this,h(),k())}};this.clear=function(){var B=r("userOptions");j("ratingValue",r("originalRatingValue"));j("ratingText",r("originalRatingText"));y(h());u(k());x();B.onClear.call(this,h(),k())};this.destroy=function(){var C=h();var D=k();var B=r("userOptions");p(s.$widget.find(".zrdn-barrating"));s.$widget.remove();z();l();s.$elem.show();B.onDestroy.call(this,C,D)}}c.prototype.init=function(d,e){this.$elem=b(e);this.options=b.extend({},b.fn.barrating.defaults,d);return this.options};return c})();b.fn.barrating=function(d,c){return this.each(function(){var e=new a();if(!b(this).is("select")){b.error("Sorry, this plugin only works with select fields.")}if(e.hasOwnProperty(d)){e.init(c,this);if(d==="show"){return e.show(c)}else{if(e.$elem.data("barrating")){e.$widget=b(this).next(".br-widget");return e[d](c)}}}else{if(typeof d==="object"||!d){c=d;e.init(c,this);return e.show()}else{b.error("Method "+d+" does not exist on jQuery.barrating")}}})};b.fn.barrating.defaults={theme:"",initialRating:null,showValues:false,showSelectedRating:true,reverse:false,readonly:false,fastClicks:true,hoverState:true,silent:false,wrapperClass:"br-wrapper",onSelect:function(d,e,c){},onClear:function(c,d){},onDestroy:function(c,d){}};b.fn.barrating.BarRating=a}));